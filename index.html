<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Heart Catch â€” For My Love</title>
  <style>
    :root{
      --bg1: #ffdff0;
      --bg2: #ffe8f4;
      --accent: #e33a6b;
    }
    html,body{height:100%;margin:0;font-family:Inter, system-ui, Arial, sans-serif}
    body{
      background: linear-gradient(180deg,var(--bg1),var(--bg2));
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
      -webkit-tap-highlight-color: transparent;
    }

    /* Cloud background */
    .sky{
      position:relative;
      width:100%;
      max-width:900px;
      height:640px;
      border-radius:18px;
      box-shadow: 0 8px 30px rgba(200,80,120,0.12);
      overflow:hidden;
      background: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.9), rgba(255,255,255,0.3) 20%, transparent 40%),
                  radial-gradient(circle at 80% 70%, rgba(255,255,255,0.85), rgba(255,255,255,0.25) 18%, transparent 36%),
                  linear-gradient(180deg, rgba(255,245,250,0.9), rgba(255,230,240,0.8));
    }

    /* soft moving clouds */
    .cloud {
      position:absolute;
      background: rgba(255,255,255,0.9);
      filter: blur(2px);
      border-radius:50%;
      opacity:0.9;
      mix-blend-mode: screen;
      animation: drift linear infinite;
    }
    /* different cloud sizes */
    .cloud.c1{width:220px;height:80px; left:10%; top:10%; animation-duration:40s;}
    .cloud.c2{width:180px;height:70px; right:5%; top:20%; animation-duration:34s; animation-delay:3s;}
    .cloud.c3{width:260px;height:100px; left:30%; top:45%; animation-duration:50s; animation-delay:-6s;}
    .cloud.c4{width:140px;height:55px; right:18%; top:60%; animation-duration:30s; animation-delay:1s;}
    @keyframes drift { 0%{transform:translateX(-6px)}50%{transform:translateX(6px)}100%{transform:translateX(-6px)} }

    /* header / UI */
    .hud{
      position:absolute;
      top:18px;
      left:20px;
      right:20px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      pointer-events:none;
    }
    .title{
      pointer-events:auto;
      background: linear-gradient(90deg,#ff8fb0,#ff5fa0);
      color:white;
      padding:8px 14px;
      border-radius:14px;
      font-weight:600;
      box-shadow:0 6px 18px rgba(230,80,120,0.15);
    }
    .score{
      pointer-events:auto;
      background:rgba(255,255,255,0.9);
      padding:8px 12px;
      border-radius:12px;
      font-weight:600;
      color:#c33a63;
      display:flex;
      align-items:center;
      gap:10px;
    }

    /* play area */
    .play-area{
      position:absolute;
      inset:0 0 70px 0; /* leave bottom space for bunny */
      overflow:hidden;
      touch-action: manipulation;
    }

    /* hearts */
    .heart{
      position:absolute;
      width:48px;
      height:48px;
      cursor:pointer;
      user-select:none;
      transform-origin:center;
      transition: transform 0.2s ease, opacity 0.3s ease;
      will-change: transform, left, top;
    }
    .heart img{width:100%;height:100%;display:block;pointer-events:none}

    /* bunny at bottom center */
    .bunny-area{
      position:absolute;
      bottom:8px;
      left:50%;
      transform:translateX(-50%);
      width:260px;
      height:180px;
      display:flex;
      align-items:flex-end;
      justify-content:center;
      pointer-events:none;
    }
    .bunny{
      width:160px;
      pointer-events:none;
      transform:translateY(0);
    }
    .basket{
      position:absolute;
      bottom:28px;
      width:120px;
      height:64px;
      border-radius:8px;
      background: linear-gradient(180deg,#f5c5d6,#ffb6cc);
      border:3px solid rgba(200,80,120,0.18);
      box-shadow: 0 6px 18px rgba(200,80,120,0.12);
      transform:translateY(10px);
      pointer-events:none;
    }

    /* overlay final message */
    .overlay{
      position:absolute;
      inset:0;
      background: rgba(0,0,0,0.25);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:40;
      opacity:0;
      pointer-events:none;
      transition: opacity 0.35s ease;
    }
    .overlay.show{ opacity:1; pointer-events:auto; }
    .win-card{
      background: linear-gradient(180deg,#fff,#fff4fb);
      padding:28px 32px;
      border-radius:16px;
      text-align:center;
      box-shadow:0 18px 50px rgba(180,50,100,0.18);
      transform: translateY(0);
    }
    .win-card h2{ margin:0 0 6px 0; color:#c02a61; font-size:28px; }
    .win-card p{ margin:0 0 12px 0; color:#b33a6b; font-weight:600; }
    .win-card button{
      background: linear-gradient(90deg,#ff7aa8,#ff5fa0);
      color:white;
      border:none;
      padding:10px 18px;
      border-radius:10px;
      font-weight:700;
      cursor:pointer;
    }

    /* small responsive tweaks */
    @media (max-width:520px){
      .sky{ height: 72vh; max-width: 420px; }
      .bunny{ width:120px; }
      .heart{ width:42px; height:42px; }
    }
  </style>
</head>
<body>
  <div class="sky" id="sky">
    <div class="hud">
      <div class="title">Heart Catch â€” For My Love ðŸ’˜</div>
      <div class="score">Score: <span id="score">0</span> / 50</div>
    </div>

    <!-- soft clouds -->
    <div class="cloud c1"></div>
    <div class="cloud c2"></div>
    <div class="cloud c3"></div>
    <div class="cloud c4"></div>

    <!-- play area -->
    <div class="play-area" id="playArea" aria-hidden="false"></div>

    <!-- bunny + basket at bottom -->
    <div class="bunny-area" aria-hidden="true">
      <div class="basket" id="basket"></div>
      <img src="bunny.png" alt="Cute bunny" class="bunny" id="bunnyImg">
    </div>

    <!-- confetti canvas -->
    <canvas id="confettiCanvas" style="position:absolute; inset:0; z-index:30; pointer-events:none;"></canvas>

    <!-- overlay -->
    <div class="overlay" id="overlay" role="dialog" aria-modal="true">
      <div class="win-card">
        <h2>Tadaa! ðŸŽ‰</h2>
        <p>Tadaa you won your Boo Boo's heart againn!! ðŸ’ž</p>
        <button id="playAgainBtn">Play again</button>
      </div>
    </div>
  </div>

  <script>
    // Config
    const HEART_COUNT = 10;
    const POINTS_PER_HEART = 5;
    const TARGET_SCORE = HEART_COUNT * POINTS_PER_HEART;

    // Elements
    const playArea = document.getElementById('playArea');
    const sky = document.getElementById('sky');
    const scoreEl = document.getElementById('score');
    const overlay = document.getElementById('overlay');
    const playAgainBtn = document.getElementById('playAgainBtn');
    const confettiCanvas = document.getElementById('confettiCanvas');

    let score = 0;
    let collected = 0;

    // set canvas size
    function resizeCanvas(){
      confettiCanvas.width = sky.clientWidth;
      confettiCanvas.height = sky.clientHeight;
      confettiCanvas.style.left = sky.offsetLeft + 'px';
      confettiCanvas.style.top = sky.offsetTop + 'px';
    }
    window.addEventListener('resize', resizeCanvas);
    window.addEventListener('load', resizeCanvas);

    // generate hearts
    function createHearts(){
      playArea.innerHTML = ''; // clear
      for(let i=0;i<HEART_COUNT;i++){
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.dataset.index = i;
        heart.dataset.collected = 'false';

        // heart image (SVG inline as img tag)
        heart.innerHTML = `<img src="data:image/svg+xml;utf8,${encodeURIComponent(heartSVG())}" alt="heart">`;

        // random starting position within play area
        const w = playArea.clientWidth;
        const h = playArea.clientHeight;
        const left = Math.random()*(w-80) + 20;
        const top = Math.random()*(h*0.6) + 20; // upper area
        heart.style.left = left + 'px';
        heart.style.top = top + 'px';

        // floating animation using CSS transform via JS intervals
        startFloatAnimation(heart);

        // click/tap handler
        heart.addEventListener('pointerdown', (e) => {
          e.preventDefault();
          collectHeart(heart);
        });

        playArea.appendChild(heart);
      }
    }

    // heart SVG (red)
    function heartSVG(){
      return `
        <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'>
          <path fill='%23e23a6a' d='M47.6 6c-5.6 0-9.9 3.6-11.6 6.1-1.7-2.5-6-6.1-11.6-6.1C13.3 6 6 13.5 6 22.2 6 37 30 48 32 52c2-4 26-15 26-29.8C58 13.5 50.7 6 47.6 6z'/>
        </svg>`;
    }

    // floating animation (vanilla) - random subtle movement
    function startFloatAnimation(el){
      let dx = (Math.random()*1.2 - 0.6);
      let dy = (Math.random()*0.6 - 0.3);
      let angle = Math.random()*360;
      let speed = 20 + Math.random()*40; // ms per frame
      let amp = 8 + Math.random()*12;

      let baseLeft = parseFloat(el.style.left);
      let baseTop = parseFloat(el.style.top);

      function step(){
        angle += 0.02 + Math.random()*0.03;
        const x = baseLeft + Math.sin(angle*1.8)*amp + Math.cos(angle*0.5)*4;
        const y = baseTop + Math.cos(angle*1.2)*amp*0.4;
        el.style.left = x + 'px';
        el.style.top = y + 'px';
        el.style.transform = `rotate(${Math.sin(angle)*10}deg) scale(${1 + Math.sin(angle*0.6)*0.04})`;
        if (el.dataset.collected === 'false'){
          el._floatTimer = requestAnimationFrame(step);
        }
      }
      el._floatTimer = requestAnimationFrame(step);
    }

    // collect heart
    function collectHeart(heart){
      if (heart.dataset.collected === 'true') return;
      heart.dataset.collected = 'true';
      cancelAnimationFrame(heart._floatTimer);

      // compute basket center in page coords
      const basket = document.getElementById('basket');
      const basketRect = basket.getBoundingClientRect();
      const skyRect = sky.getBoundingClientRect();

      // make a flying clone to animate to basket
      const clone = heart.cloneNode(true);
      clone.style.position = 'absolute';
      const rect = heart.getBoundingClientRect();
      clone.style.left = (rect.left - skyRect.left) + 'px';
      clone.style.top = (rect.top - skyRect.top) + 'px';
      clone.style.width = rect.width + 'px';
      clone.style.height = rect.height + 'px';
      clone.style.transition = 'transform 0.6s cubic-bezier(.2,.9,.2,1), left 0.6s cubic-bezier(.2,.9,.2,1), top 0.6s cubic-bezier(.2,.9,.2,1), opacity 0.5s';
      clone.style.zIndex = 20;
      playArea.appendChild(clone);

      // hide original immediately for cleanliness
      heart.style.opacity = '0';
      heart.style.pointerEvents = 'none';

      // target position center of basket
      const targetX = basketRect.left + basketRect.width/2 - skyRect.left - clone.clientWidth/2;
      const targetY = basketRect.top + basketRect.height/2 - skyRect.top - clone.clientHeight/2;

      // small scale up as it moves
      requestAnimationFrame(() => {
        clone.style.left = targetX + 'px';
        clone.style.top = targetY + 'px';
        clone.style.transform = 'scale(0.6) rotate(20deg)';
        clone.style.opacity = '0.9';
      });

      // after animation, remove clone and update score
      setTimeout(() => {
        clone.remove();
        score += POINTS_PER_HEART;
        collected += 1;
        scoreEl.textContent = score;
        // small basket bounce
        bounceBasket();
        // show small pop effect
        smallPop(targetX, targetY);
        if (score >= TARGET_SCORE){
          setTimeout(showWin, 450);
        }
      }, 650);
    }

    function bounceBasket(){
      const basket = document.getElementById('basket');
      basket.animate([
        { transform: 'translateY(10px)' },
        { transform: 'translateY(0px)' },
        { transform: 'translateY(6px)' },
        { transform: 'translateY(0px)' }
      ], { duration: 450, easing: 'cubic-bezier(.2,.9,.2,1)'});
    }

    // small pop particle using canvas (tiny)
    function smallPop(x,y){
      // optional: skip for brevity â€” we use confetti on win
    }

    // show win overlay + confetti
    function showWin(){
      overlay.classList.add('show');
      // start confetti for a while
      runConfettiFor(2200);
    }

    playAgainBtn.addEventListener('click', () => {
      resetGame();
    });

    function resetGame(){
      score = 0;
      collected = 0;
      scoreEl.textContent = score;
      overlay.classList.remove('show');
      createHearts();
    }

    // --- Simple confetti engine ---
    function runConfettiFor(duration = 2000){
      const ctx = confettiCanvas.getContext('2d');
      const W = confettiCanvas.width;
      const H = confettiCanvas.height;
      const pieces = [];
      const colors = ['#ff5fa0','#ff7aa8','#ffd2e6','#ffe37b','#ff8fb0','#e23a6a'];

      for(let i=0;i<120;i++){
        pieces.push({
          x: Math.random()*W,
          y: -Math.random()*H*0.5,
          r: 6+Math.random()*8,
          d: Math.random()*Math.PI*2,
          velY: 2+Math.random()*4,
          velX: (Math.random()*6)-3,
          color: colors[Math.floor(Math.random()*colors.length)],
          rot: Math.random()*360,
          rotSpeed: (Math.random()*8)-4
        });
      }
      let start = null;
      function frame(ts){
        if (!start) start = ts;
        const elapsed = ts - start;
        ctx.clearRect(0,0,W,H);
        for(const p of pieces){
          p.x += p.velX;
          p.y += p.velY;
          p.velY += 0.02; // gravity
          p.rot += p.rotSpeed*0.5;
          ctx.save();
          ctx.translate(p.x,p.y);
          ctx.rotate(p.rot * Math.PI/180);
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.r/2,-p.r/2,p.r, p.r*0.6);
          ctx.restore();
        }
        if (elapsed < duration) {
          requestAnimationFrame(frame);
        } else {
          // fade out quickly
          setTimeout(()=> ctx.clearRect(0,0,W,H), 350);
        }
      }
      requestAnimationFrame(frame);
    }

    // init
    resizeCanvas();
    createHearts();

    // Accessibility: allow keyboard "Enter" to collect nearest heart under pointer? (optional)
    // but primary is tap/click

    // If the user navigates away/resizes while hearts are running, cancel old anims
    window.addEventListener('beforeunload', () => {
      const hearts = document.querySelectorAll('.heart');
      hearts.forEach(h => cancelAnimationFrame(h._floatTimer));
    });
  </script>
</body>
</html>
